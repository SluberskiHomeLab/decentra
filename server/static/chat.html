<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decentra - Chat</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <!-- Announcement Banner -->
    <div id="announcement-banner" class="announcement-banner hidden" role="status" aria-live="polite">
        <div class="announcement-content">
            <span class="announcement-icon">üì¢</span>
            <span id="announcement-text"></span>
        </div>
        <button id="close-announcement" class="announcement-close" title="Dismiss" aria-label="Dismiss announcement">‚úï</button>
    </div>
    
    <!-- Mobile overlay -->
    <div id="mobile-overlay" class="mobile-overlay" role="button" aria-label="Close menu" tabindex="0"></div>
    
    <div class="main-container">
        <!-- Left Sidebar: Servers and DMs -->
        <div id="left-sidebar" class="left-sidebar">
            <div class="sidebar-header">
                <h3>Decentra</h3>
            </div>
            
            <div class="servers-section">
                <div class="section-header">
                    <h4>Servers</h4>
                </div>
                <div id="servers-list" class="items-list">
                    <!-- Server items will be added here -->
                </div>
            </div>
            
            <div class="dms-section">
                <div class="section-header">
                    <h4>Direct Messages</h4>
                </div>
                <div id="dms-list" class="items-list">
                    <!-- DM items will be added here -->
                </div>
            </div>
            
            <div class="user-section">
                <span id="current-user-avatar" class="user-avatar">üë§</span>
                <span id="current-user" class="username-display"></span>
                <button id="user-menu-btn" class="btn btn-small btn-icon" title="Menu">‚öô</button>
                <div id="user-menu" class="user-menu hidden">
                    <button id="menu-profile-btn" class="menu-item">Profile Settings</button>
                    <button id="menu-avatar-btn" class="menu-item">Set Avatar</button>
                    <button id="menu-notifications-btn" class="menu-item">Notification Settings</button>
                    <button id="menu-friends-btn" class="menu-item">Friends</button>
                    <button id="menu-create-server-btn" class="menu-item">Create Server</button>
                    <button id="menu-join-server-btn" class="menu-item">Join Server</button>
                    <button id="menu-invite-btn" class="menu-item">Generate Invite</button>
                    <button id="menu-admin-btn" class="menu-item hidden">Admin Settings</button>
                    <div class="menu-divider"></div>
                    <button id="menu-logout-btn" class="menu-item menu-item-danger">Logout</button>
                </div>
            </div>
        </div>
        
        <!-- Middle Sidebar: Channels or Friends -->
        <div id="middle-sidebar" class="middle-sidebar">
            <div id="channels-view" class="sidebar-view">
                <div class="sidebar-header">
                    <h3 id="server-name">Select a Server</h3>
                    <button id="server-settings-btn" class="btn btn-small btn-icon hidden" title="Server Settings">‚öô</button>
                </div>
                <div id="channels-list" class="items-list">
                    <!-- Channel items will be added here -->
                </div>
            </div>
            
            <div id="friends-view" class="sidebar-view hidden">
                <div class="sidebar-header">
                    <h3>Friends</h3>
                    <button id="search-users-btn" class="btn btn-small btn-primary">Search Users</button>
                </div>
                <div id="friends-list" class="items-list">
                    <!-- Friend items will be added here -->
                </div>
            </div>
        </div>
        
        <!-- Main Chat Area -->
        <div class="chat-container">
            <div class="chat-header">
                <button id="mobile-menu-toggle" class="mobile-menu-toggle" title="Menu" aria-label="Toggle navigation menu" aria-expanded="false">‚ò∞</button>
                <h2 id="chat-title">Welcome to Decentra</h2>
            </div>
            
            <div id="messages" class="messages-container">
                <div class="welcome-message">
                    <h2>Welcome to Decentra!</h2>
                    <p>Create a server, add friends, or start a conversation.</p>
                    <ul>
                        <li>Click the <strong>‚öô menu button</strong> (bottom left) to create a server or access features</li>
                        <li>Click <strong>Friends</strong> in the menu to search and add friends</li>
                        <li>Start direct messages with your friends</li>
                    </ul>
                </div>
            </div>
            
            <div class="input-container">
                <form id="message-form">
                    <div class="message-input-wrapper">
                        <input type="text" id="message-input" placeholder="Select a channel or DM to start chatting..." autocomplete="off" disabled>
                        <div id="mention-autocomplete" class="mention-autocomplete hidden">
                            <!-- Mention suggestions will be populated here -->
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" disabled>Send</button>
                </form>
            </div>
            
            <!-- Voice controls panel -->
            <div id="voice-controls" class="voice-controls hidden">
                <div class="voice-status">
                    <span id="voice-status-text">In Voice Channel</span>
                </div>
                <div class="voice-buttons">
                    <button id="mic-settings-btn" class="btn btn-secondary btn-icon" title="Microphone Settings">‚öôÔ∏èüé§</button>
                    <button id="mute-btn" class="btn btn-secondary btn-icon" title="Mute/Unmute">üé§</button>
                    <button id="video-btn" class="btn btn-secondary btn-icon" title="Toggle Video">üìπ</button>
                    <button id="screen-share-btn" class="btn btn-secondary btn-icon" title="Share Screen">üñ•Ô∏è</button>
                    <button id="leave-voice-btn" class="btn btn-danger">Leave Voice</button>
                </div>
            </div>
            
        </div>
        
        <!-- Video Call Area (shown during calls) -->
        <div id="video-call-area" class="video-call-area hidden">
            <div class="video-main-display">
                <div id="video-grid" class="video-grid">
                    <!-- Video streams will be added here -->
                </div>
                <div id="maximized-video-container" class="maximized-video-container hidden">
                    <!-- Maximized video will be shown here -->
                    <button id="minimize-video-btn" class="minimize-video-btn">‚úï</button>
                </div>
            </div>
            <div id="voice-participants" class="voice-participants-sidebar">
                <div class="participants-header">
                    <h4>Participants</h4>
                </div>
                <div id="participants-list" class="participants-list">
                    <!-- Participants will be added here -->
                </div>
            </div>
        </div>
        
        <!-- Right Sidebar: Server Members -->
        <div id="right-sidebar" class="right-sidebar hidden">
            <div class="sidebar-header">
                <h3>Members</h3>
                <button id="toggle-members-btn" class="btn btn-small btn-icon" title="Collapse">‚óÄ</button>
            </div>
            <div id="server-members-display" class="items-list">
                <!-- Server members will be added here -->
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="incoming-call-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Incoming Voice Call</h3>
            <p id="caller-name"></p>
            <div class="button-group">
                <button id="accept-call-btn" class="btn btn-success">Accept</button>
                <button id="reject-call-btn" class="btn btn-danger">Reject</button>
            </div>
        </div>
    </div>
    <div id="invite-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Invite Code Generated</h3>
            <div class="invite-code-display">
                <code id="invite-code-text"></code>
            </div>
            <p>Share this code with someone you want to invite</p>
            <button id="close-invite-modal" class="btn btn-primary">Close</button>
        </div>
    </div>
    
    <div id="create-server-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Server</h3>
            <form id="create-server-form">
                <div class="form-group">
                    <label for="server-name-input">Server Name</label>
                    <input type="text" id="server-name-input" required>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Create</button>
                    <button type="button" id="cancel-server-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="join-server-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Join Server</h3>
            <form id="join-server-form">
                <div class="form-group">
                    <label for="server-invite-input">Invite Code</label>
                    <input type="text" id="server-invite-input" placeholder="Enter server invite code" required>
                </div>
                <div id="join-server-error" class="error hidden"></div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Join Server</button>
                    <button type="button" id="cancel-join-server-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="create-voice-channel-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Voice Channel</h3>
            <form id="create-voice-channel-form">
                <div class="form-group">
                    <label for="voice-channel-name-input">Voice Channel Name</label>
                    <input type="text" id="voice-channel-name-input" required>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Create</button>
                    <button type="button" id="cancel-voice-channel-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="create-text-channel-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Text Channel</h3>
            <form id="create-text-channel-form">
                <div class="form-group">
                    <label for="text-channel-name-input">Text Channel Name</label>
                    <input type="text" id="text-channel-name-input" required>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">Create</button>
                    <button type="button" id="cancel-text-channel-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="search-users-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Search Users</h3>
            <div class="form-group">
                <input type="text" id="search-users-input" placeholder="Type username...">
            </div>
            <div id="search-results" class="search-results">
                <!-- Search results will be added here -->
            </div>
            <button id="close-search-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <div id="server-settings-modal" class="modal hidden">
        <div class="modal-content modal-content-large">
            <h3>Server Settings</h3>
            <div class="settings-tabs">
                <button class="settings-tab active" data-tab="general">General</button>
                <button class="settings-tab" data-tab="channels">Channels</button>
                <button class="settings-tab" data-tab="emojis">Emojis</button>
                <button class="settings-tab" data-tab="invites">Invites</button>
                <button class="settings-tab" data-tab="roles">Roles</button>
                <button class="settings-tab" data-tab="permissions">Permissions</button>
            </div>
            
            <div id="settings-tab-general" class="settings-tab-content">
                <h4>Server Name</h4>
                <form id="rename-server-form">
                    <div class="form-group">
                        <label for="new-server-name-input">New Server Name</label>
                        <input type="text" id="new-server-name-input" required>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">Rename Server</button>
                    </div>
                </form>
                
                <h4>Server Icon</h4>
                <div class="server-icon-selector">
                    <div class="icon-tabs">
                        <button class="icon-tab active" data-tab="emoji">Emoji</button>
                        <button class="icon-tab" data-tab="upload">Upload Image</button>
                    </div>
                    
                    <div id="server-icon-tab-emoji" class="icon-tab-content">
                        <p>Select an emoji for your server icon:</p>
                        <div class="emoji-grid">
                            <button class="emoji-option" data-emoji="üè†">üè†</button>
                            <button class="emoji-option" data-emoji="üéÆ">üéÆ</button>
                            <button class="emoji-option" data-emoji="üí¨">üí¨</button>
                            <button class="emoji-option" data-emoji="üéµ">üéµ</button>
                            <button class="emoji-option" data-emoji="üé®">üé®</button>
                            <button class="emoji-option" data-emoji="üöÄ">üöÄ</button>
                            <button class="emoji-option" data-emoji="‚ö°">‚ö°</button>
                            <button class="emoji-option" data-emoji="üî•">üî•</button>
                            <button class="emoji-option" data-emoji="üíé">üíé</button>
                            <button class="emoji-option" data-emoji="üåü">üåü</button>
                            <button class="emoji-option" data-emoji="üéØ">üéØ</button>
                            <button class="emoji-option" data-emoji="üé™">üé™</button>
                        </div>
                    </div>
                    
                    <div id="server-icon-tab-upload" class="icon-tab-content hidden">
                        <p>Upload a server icon (PNG, JPG, GIF - Max 2MB)</p>
                        <div class="avatar-upload-area">
                            <label for="server-icon-file-input" class="file-upload-label">
                                <div class="file-upload-placeholder">
                                    <span id="server-icon-preview">üìÅ Choose an image</span>
                                </div>
                            </label>
                            <input type="file" id="server-icon-file-input" accept="image/*" style="display: none;">
                            <button id="upload-server-icon-btn" class="btn btn-success hidden">Upload Icon</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="settings-tab-channels" class="settings-tab-content hidden">
                <h4>Create Channels</h4>
                <p>Create new text or voice channels for this server.</p>
                <div class="button-group">
                    <button id="create-text-channel-btn" class="btn btn-primary">Create Text Channel</button>
                    <button id="create-voice-channel-btn" class="btn btn-primary">Create Voice Channel</button>
                </div>
            </div>
            
            <div id="settings-tab-emojis" class="settings-tab-content hidden">
                <h4>Custom Emojis</h4>
                <p>Upload and manage custom emojis for this server.</p>
                <button id="upload-custom-emoji-btn" class="btn btn-primary">Upload Emoji</button>
                <div id="server-emojis-list" class="custom-emojis-list">
                    <!-- Custom emojis will be populated here -->
                </div>
            </div>
            
            <div id="settings-tab-invites" class="settings-tab-content hidden">
                <h4>Server Invites</h4>
                <p>Generate invite codes to invite others to this server.</p>
                <button id="generate-server-invite-btn" class="btn btn-primary">Generate Invite Code</button>
                <div id="server-invite-display" class="invite-code-display hidden">
                    <div class="invite-display-header">
                        <label>Invite Code:</label>
                        <code id="server-invite-code-text"></code>
                    </div>
                    <div class="invite-display-header">
                        <label>Invite Link:</label>
                        <code id="server-invite-link-text"></code>
                    </div>
                    <div class="invite-actions">
                        <button id="copy-invite-link-btn" class="btn btn-secondary">üìã Copy Link</button>
                        <button id="send-invite-to-friends-btn" class="btn btn-primary">üì§ Send to Friends</button>
                    </div>
                </div>
            </div>
            
            <div id="settings-tab-roles" class="settings-tab-content hidden">
                <h4>Server Roles</h4>
                <p>Manage roles and permissions for your server members.</p>
                <button id="open-roles-manager-btn" class="btn btn-primary">Manage Roles</button>
            </div>
            
            <div id="settings-tab-permissions" class="settings-tab-content hidden">
                <h4>User Permissions</h4>
                <p>Manage what each user can do in this server.</p>
                <div id="server-members-list" class="members-list">
                    <!-- Members will be populated here -->
                </div>
            </div>
            
            <button id="close-server-settings-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <div id="avatar-settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Choose Your Avatar</h3>
            <div class="avatar-tabs">
                <button class="avatar-tab active" data-tab="emoji">Emoji</button>
                <button class="avatar-tab" data-tab="upload">Upload Image</button>
            </div>
            
            <div id="avatar-tab-emoji" class="avatar-tab-content">
                <p>Select an emoji to represent you</p>
                <div id="avatar-picker" class="avatar-picker">
                    <button class="avatar-option" data-avatar="üë§">üë§</button>
                    <button class="avatar-option" data-avatar="üòÄ">üòÄ</button>
                    <button class="avatar-option" data-avatar="üòé">üòé</button>
                    <button class="avatar-option" data-avatar="ü§ñ">ü§ñ</button>
                    <button class="avatar-option" data-avatar="üë®">üë®</button>
                    <button class="avatar-option" data-avatar="üë©">üë©</button>
                    <button class="avatar-option" data-avatar="üßë">üßë</button>
                    <button class="avatar-option" data-avatar="üë¶">üë¶</button>
                    <button class="avatar-option" data-avatar="üëß">üëß</button>
                    <button class="avatar-option" data-avatar="üê∂">üê∂</button>
                    <button class="avatar-option" data-avatar="üê±">üê±</button>
                    <button class="avatar-option" data-avatar="üêº">üêº</button>
                    <button class="avatar-option" data-avatar="ü¶ä">ü¶ä</button>
                    <button class="avatar-option" data-avatar="üêª">üêª</button>
                    <button class="avatar-option" data-avatar="üêØ">üêØ</button>
                    <button class="avatar-option" data-avatar="ü¶Å">ü¶Å</button>
                    <button class="avatar-option" data-avatar="üê∏">üê∏</button>
                    <button class="avatar-option" data-avatar="üêµ">üêµ</button>
                    <button class="avatar-option" data-avatar="ü¶Ñ">ü¶Ñ</button>
                    <button class="avatar-option" data-avatar="üêâ">üêâ</button>
                </div>
            </div>
            
            <div id="avatar-tab-upload" class="avatar-tab-content hidden">
                <p>Upload a profile picture (PNG, JPG, GIF - Max 2MB)</p>
                <div class="avatar-upload-area">
                    <div id="avatar-preview" class="avatar-preview hidden">
                        <img id="avatar-preview-img" src="" alt="Avatar preview">
                    </div>
                    <input type="file" id="avatar-file-input" accept="image/png,image/jpeg,image/jpg,image/gif" style="display: none;">
                    <button id="select-file-btn" class="btn btn-primary">Select Image</button>
                    <button id="upload-avatar-btn" class="btn btn-success hidden">Upload Avatar</button>
                    <button id="remove-avatar-btn" class="btn btn-danger hidden">Remove Custom Avatar</button>
                </div>
            </div>
            
            <button id="close-avatar-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <div id="profile-settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Profile Settings</h3>
            
            <div class="form-group">
                <label for="status-message-input">Status Message</label>
                <input type="text" id="status-message-input" class="form-input" placeholder="What's on your mind?" maxlength="100">
                <small style="color: #b9bbbe; font-size: 12px;">Maximum 100 characters</small>
            </div>
            
            <div class="form-group">
                <label for="bio-input">Bio</label>
                <textarea id="bio-input" class="form-input" placeholder="Tell others about yourself..." maxlength="500" rows="4" wrap="soft"></textarea>
                <small style="color: #b9bbbe; font-size: 12px;">Maximum 500 characters</small>
            </div>
            
            <div class="modal-buttons">
                <button id="save-profile-btn" class="btn btn-primary">Save Profile</button>
                <button id="close-profile-modal" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>
    
    <div id="device-settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Audio/Video Settings</h3>
            
            <div class="form-group">
                <label for="microphone-select">Microphone</label>
                <select id="microphone-select" class="device-select">
                    <option value="">Default</option>
                </select>
                <button id="test-microphone-btn" class="btn btn-small" style="margin-top: 5px;">Test Microphone</button>
                <div id="mic-test-status" style="margin-top: 5px; font-size: 12px; color: #b9bbbe;"></div>
            </div>
            
            <div class="form-group">
                <label for="speaker-select">Speaker</label>
                <select id="speaker-select" class="device-select">
                    <option value="">Default</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="camera-select">Camera</label>
                <select id="camera-select" class="device-select">
                    <option value="">Default</option>
                </select>
            </div>
            
            <button id="close-device-settings-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <!-- Notification Settings Modal -->
    <div id="notification-settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Notification Settings</h3>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="enable-notifications" checked>
                    Enable Browser Notifications
                </label>
                <p style="font-size: 12px; color: #b9bbbe; margin-top: 5px;">
                    Show desktop notifications for new messages and calls
                </p>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="enable-notification-sounds" checked>
                    Enable Notification Sounds
                </label>
                <p style="font-size: 12px; color: #b9bbbe; margin-top: 5px;">
                    Play sounds when receiving messages and calls
                </p>
            </div>
            
            <div class="form-group">
                <label for="notification-mode-select">Notification Mode</label>
                <select id="notification-mode-select" class="device-select">
                    <option value="all">All Messages</option>
                    <option value="mentions">Mentions Only</option>
                    <option value="none">None</option>
                </select>
                <p style="font-size: 12px; color: #b9bbbe; margin-top: 5px;">
                    Choose when to receive notifications: for all messages, only when mentioned, or never
                </p>
            </div>
            
            <div class="form-group">
                <label for="message-sound-select">Message Notification Sound</label>
                <select id="message-sound-select" class="device-select">
                    <option value="soft-ping">Soft Ping</option>
                    <option value="gentle-chime">Gentle Chime</option>
                    <option value="subtle-pop">Subtle Pop</option>
                </select>
                <button id="test-message-sound-btn" class="btn btn-small" style="margin-top: 5px;">Test Sound</button>
            </div>
            
            <div class="form-group">
                <label for="call-sound-select">Call Notification Sound</label>
                <select id="call-sound-select" class="device-select">
                    <option value="classic-ring">Classic Ring</option>
                    <option value="modern-tone">Modern Tone</option>
                    <option value="upbeat-call">Upbeat Call</option>
                </select>
                <button id="test-call-sound-btn" class="btn btn-small" style="margin-top: 5px;">Test Sound</button>
            </div>
            
            <button id="close-notification-settings-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <!-- Screen Share Settings Modal -->
    <div id="screen-share-settings-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Screen Share Settings</h3>
            
            <div class="form-group">
                <label for="screen-resolution-select">Resolution</label>
                <select id="screen-resolution-select" class="device-select">
                    <option value="1080">1920x1080 (1080p)</option>
                    <option value="720" selected>1280x720 (720p)</option>
                    <option value="480">854x480 (480p)</option>
                </select>
                <p style="font-size: 12px; color: #b9bbbe; margin-top: 5px;">
                    Higher resolutions require more bandwidth
                </p>
            </div>
            
            <div class="form-group">
                <label for="screen-framerate-select">Frame Rate</label>
                <select id="screen-framerate-select" class="device-select">
                    <option value="60">60 FPS</option>
                    <option value="30" selected>30 FPS</option>
                    <option value="15">15 FPS</option>
                </select>
                <p style="font-size: 12px; color: #b9bbbe; margin-top: 5px;">
                    Higher frame rates provide smoother motion but use more bandwidth
                </p>
            </div>
            
            <div class="button-group">
                <button id="start-screen-share-btn" class="btn btn-primary">Share Screen</button>
                <button id="cancel-screen-share-btn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Roles Management Modal -->
    <div id="roles-modal" class="modal hidden">
        <div class="modal-content modal-content-large">
            <h3>Server Roles</h3>
            <div class="roles-container">
                <div class="roles-sidebar">
                    <div class="roles-header">
                        <h4>Roles</h4>
                        <button id="create-role-btn" class="btn btn-small btn-primary">+ Create Role</button>
                    </div>
                    <div id="roles-list" class="roles-list">
                        <!-- Roles will be listed here -->
                    </div>
                </div>
                
                <div class="role-editor" id="role-editor">
                    <div class="role-editor-placeholder">
                        <p>Select a role to edit or create a new one</p>
                    </div>
                </div>
                
                <div class="role-editor hidden" id="role-edit-form">
                    <div class="form-group">
                        <label for="role-name-input">Role Name</label>
                        <input type="text" id="role-name-input" placeholder="Enter role name">
                    </div>
                    
                    <div class="form-group">
                        <label for="role-color-input">Role Color</label>
                        <div class="color-picker-container">
                            <input type="color" id="role-color-input" value="#99AAB5">
                            <span id="role-color-preview" class="role-color-preview"></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Permissions</label>
                        <div class="permissions-list">
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-create-invite" class="permission-checkbox" data-permission="create_invite">
                                    <span>Create Server Invites</span>
                                </label>
                                <p class="permission-desc">Allow members to invite new people to the server</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-create-channel" class="permission-checkbox" data-permission="create_channel">
                                    <span>Create Channels</span>
                                </label>
                                <p class="permission-desc">Allow members to create text channels</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-create-voice" class="permission-checkbox" data-permission="create_voice_channel">
                                    <span>Create Voice Channels</span>
                                </label>
                                <p class="permission-desc">Allow members to create voice channels</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-delete-messages" class="permission-checkbox" data-permission="delete_messages">
                                    <span>Delete Messages</span>
                                </label>
                                <p class="permission-desc">Allow members to delete messages from others</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-edit-messages" class="permission-checkbox" data-permission="edit_messages">
                                    <span>Edit Messages</span>
                                </label>
                                <p class="permission-desc">Allow members to edit messages from others</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-send-files" class="permission-checkbox" data-permission="send_files">
                                    <span>Send Files</span>
                                </label>
                                <p class="permission-desc">Allow members to upload and send files</p>
                            </div>
                            
                            <div class="permission-item">
                                <label>
                                    <input type="checkbox" id="perm-access-settings" class="permission-checkbox" data-permission="access_settings">
                                    <span>Access Server Settings</span>
                                </label>
                                <p class="permission-desc">Allow members to access and modify server settings</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Members with this role</label>
                        <div id="role-members-list" class="role-members-list">
                            <!-- Members will be listed here -->
                        </div>
                        <button id="assign-role-btn" class="btn btn-small btn-secondary">Add Members</button>
                    </div>
                    
                    <div class="button-group">
                        <button id="save-role-btn" class="btn btn-primary">Save Role</button>
                        <button id="delete-role-btn" class="btn btn-danger">Delete Role</button>
                        <button id="cancel-role-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>
            
            <button id="close-roles-modal" class="btn btn-secondary" style="margin-top: 20px;">Close</button>
        </div>
    </div>
    
    <!-- Assign Role to Members Modal -->
    <div id="assign-role-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Add Members to Role</h3>
            <div id="available-members-list" class="available-members-list">
                <!-- Available members will be listed here -->
            </div>
            <button id="close-assign-modal" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <!-- Send Invite to Friends Modal -->
    <div id="send-invite-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Send Server Invite</h3>
            <p>Select friends to send the invite link to:</p>
            <div id="invite-friends-list" class="invite-friends-list">
                <!-- Friends will be listed here -->
            </div>
            <div class="modal-actions">
                <button id="send-selected-invites-btn" class="btn btn-primary">Send Invites</button>
                <button id="close-send-invite-modal" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Upload Custom Emoji Modal -->
    <div id="upload-emoji-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Upload Custom Emoji</h3>
            <form id="upload-emoji-form">
                <div class="form-group">
                    <label for="emoji-name-input">Emoji Name:</label>
                    <input type="text" id="emoji-name-input" placeholder="e.g. happy_cat" required pattern="[a-zA-Z0-9_]+" maxlength="50">
                    <small>Letters, numbers, and underscores only</small>
                </div>
                <div class="form-group">
                    <label for="emoji-file-input">Image File:</label>
                    <input type="file" id="emoji-file-input" accept="image/png,image/jpeg,image/gif,image/webp" required>
                    <small>PNG, JPEG, GIF, or WebP (max 256KB)</small>
                </div>
                <div id="emoji-preview-container" class="emoji-preview-container hidden">
                    <img id="emoji-preview" alt="Preview">
                </div>
                <div id="upload-emoji-error" class="error-message"></div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Upload</button>
                    <button type="button" id="cancel-upload-emoji-btn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Emoji Picker Modal -->
    <div id="emoji-picker-modal" class="modal hidden">
        <div class="modal-content emoji-picker-content">
            <h3>Pick an Emoji</h3>
            <div class="emoji-picker-tabs">
                <button class="emoji-tab active" data-tab="standard">Standard</button>
                <button class="emoji-tab" data-tab="custom">Custom</button>
            </div>
            <div class="emoji-picker-container">
                <div id="standard-emojis" class="emoji-grid active">
                    <!-- Standard emojis will be populated here -->
                </div>
                <div id="custom-emojis" class="emoji-grid hidden">
                    <!-- Custom emojis will be populated here -->
                </div>
            </div>
            <button id="close-emoji-picker" class="btn btn-secondary">Close</button>
        </div>
    </div>
    
    <script src="/static/notifications.js"></script>
    <script src="/static/voice.js"></script>
    <script src="/static/chat.js"></script>
</body>
</html>
